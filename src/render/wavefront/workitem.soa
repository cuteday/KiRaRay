flat int;
flat uint;
flat float;
flat bool;
flat double;
flat Light;
flat BsdfType;
flat ShadingData;
flat LCGSampler;
flat PCGSampler;
flat HaltonSampler;

flat vec2f;
flat vec2i;
flat vec3f;

struct Ray{ vec3f origin, dir; };
struct LightSampleContext{ vec3f p, n; };

struct PixelState {
	vec3f L;
	PCGSampler sampler;
};

struct RayWorkItem {
	Ray ray;
	LightSampleContext ctx;
	float pdf;
	vec3f thp;
	uint depth;
	uint pixelId;
};

struct MissRayWorkItem {
	Ray ray;
	LightSampleContext ctx;
	float pdf;
	vec3f thp;
	uint depth;
	uint pixelId;
};

struct HitLightWorkItem {
	Light light;
	LightSampleContext ctx;
	float pdf;
	vec3f p;
	vec3f wo;
	vec3f n;
	vec2f uv;
	vec3f thp;
	uint depth;
	uint pixelId;
};

struct ShadowRayWorkItem {
	Ray ray;
	float tMax;
	vec3f Li;
	vec3f a;
	uint pixelId;
};

struct ScatterRayWorkItem {
	vec3f thp;
	ShadingData sd;
	uint depth;
	uint pixelId;
};